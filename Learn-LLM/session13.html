<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session 13: Custom Model Training - LLM Studio Course</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); min-height: 100vh; }
        .content-section { background: white; border-radius: 12px; padding: 2rem; margin: 2rem 0; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .session-header { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; }
        .key-concept { background: rgba(139, 92, 246, 0.1); border-left: 4px solid #8b5cf6; padding: 1.5rem; margin: 1.5rem 0; border-radius: 0 8px 8px 0; }
        .code-example { background: #1e1e1e; color: #f8f8f2; padding: 1rem; border-radius: 8px; margin: 1rem 0; font-family: 'JetBrains Mono', monospace; }
        .time-indicator { background: #f3f0ff; padding: 0.5rem 1rem; border-radius: 20px; display: inline-block; margin-bottom: 1rem; color: #7c3aed; }
        .progress-indicator { background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); height: 4px; border-radius: 2px; margin-bottom: 2rem; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid #e5e7eb; }
        .expert-project { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; border-radius: 12px; padding: 2rem; margin: 2rem 0; }
        .warning-card { background: rgba(245, 101, 101, 0.1); border: 1px solid rgba(245, 101, 101, 0.3); border-radius: 8px; padding: 1rem; margin: 1rem 0; }
        .step-advanced { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); border-radius: 8px; padding: 1.5rem; margin: 1rem 0; border-left: 4px solid #8b5cf6; }
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin: 1.5rem 0; }
        .metric-card { background: white; padding: 1rem; border-radius: 8px; text-align: center; border: 1px solid #e5e7eb; }
        .metric-value { font-size: 1.5rem; font-weight: bold; color: #8b5cf6; margin-bottom: 0.5rem; }
        .metric-label { font-size: 0.9rem; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html">
                <i class="fas fa-brain text-primary me-2"></i>LLM Studio Course
            </a>
            <div class="d-flex align-items-center">
                <span class="badge bg-dark me-2">Session 13 of 15</span>
                <span class="text-muted small">45 min + 60 min project</span>
            </div>
        </div>
    </nav>

    <!-- Progress Bar -->
    <div class="container">
        <div class="progress-indicator" style="width: 86.67%;"></div>
    </div>

    <!-- Session Header -->
    <div class="container">
        <div class="session-header">
            <div class="d-flex justify-content-between align-items-start">
                <div>
                    <h1 class="display-5 fw-bold mb-3">Session 13: Custom Model Training</h1>
                    <p class="lead mb-0">Train your own language models from scratch using advanced techniques</p>
                </div>
                <div class="text-end">
                    <div class="time-indicator">
                        <i class="fas fa-clock me-1"></i>45 min + 60 min project
                    </div>
                    <div class="badge bg-white text-dark">
                        <i class="fas fa-atom me-1"></i>Expert Level
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Learning Objectives -->
        <div class="content-section">
            <h2 class="h4 mb-3"><i class="fas fa-bullseye text-primary me-2"></i>Learning Objectives</h2>
            <div class="row">
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Understand training fundamentals</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Master data preparation techniques</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Configure training hyperparameters</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Monitor training progress</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Evaluate model performance</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Deploy custom trained models</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Prerequisites Warning -->
        <div class="content-section">
            <div class="warning-card">
                <h4 class="h5 text-danger mb-3"><i class="fas fa-exclamation-triangle me-2"></i>Expert Level Prerequisites</h4>
                <p><strong>This session requires:</strong></p>
                <ul class="mb-0">
                    <li>High-end GPU (RTX 3090 or better recommended)</li>
                    <li>64GB+ RAM for large models</li>
                    <li>Advanced Python and machine learning knowledge</li>
                    <li>Understanding of transformer architectures</li>
                    <li>Significant time investment (days to weeks)</li>
                    <li>Quality dataset preparation</li>
                </ul>
                <p class="mt-2"><strong>Not recommended for beginners.</strong> Consider fine-tuning existing models first (Session 14).</p>
            </div>
        </div>

        <!-- Training Fundamentals -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-graduation-cap text-primary me-2"></i>Training Fundamentals</h2>

            <div class="key-concept">
                <h4 class="h5 text-primary mb-3">üéØ Why Train Custom Models?</h4>
                <p>Custom training is necessary when:</p>
                <ul class="mb-0">
                    <li><strong>Domain expertise:</strong> Specialized knowledge not in general models</li>
                    <li><strong>Unique datasets:</strong> Proprietary or domain-specific data</li>
                    <li><strong>Performance optimization:</strong> Smaller, faster models for specific tasks</li>
                    <li><strong>Privacy requirements:</strong> Keep data completely local</li>
                    <li><strong>Innovation:</strong> Push boundaries of what's possible</li>
                </ul>
            </div>

            <div class="row mt-4">
                <div class="col-md-6">
                    <h5 class="text-success mb-3">Training Approaches</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>From Scratch:</strong> Train entirely new model</li>
                        <li class="list-group-item"><strong>Continued Pre-training:</strong> Extend existing model</li>
                        <li class="list-group-item"><strong>Instruction Tuning:</strong> Teach specific behaviors</li>
                        <li class="list-group-item"><strong>Domain Adaptation:</strong> Specialize for domain</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5 class="text-info mb-3">Resource Requirements</h5>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value">1-7B</div>
                            <div class="metric-label">Small Model</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">13-30B</div>
                            <div class="metric-label">Medium Model</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">65B+</div>
                            <div class="metric-label">Large Model</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">A100</div>
                            <div class="metric-label">GPU Required</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Preparation -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-database text-primary me-2"></i>Data Preparation Pipeline</h2>

            <div class="step-advanced">
                <h5 class="text-primary mb-3">Step 1: Data Collection</h5>
                <div class="row">
                    <div class="col-md-8">
                        <ul>
                            <li><strong>Source identification:</strong> Books, articles, code repositories, domain-specific texts</li>
                            <li><strong>Quality filtering:</strong> Remove low-quality, biased, or inappropriate content</li>
                            <li><strong>Diversity:</strong> Ensure broad coverage of topics and writing styles</li>
                            <li><strong>Volume:</strong> Minimum 1GB of text for meaningful training</li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <div class="code-example">
Data Sources:
‚îú‚îÄ‚îÄ Books (20%)
‚îú‚îÄ‚îÄ Articles (30%)
‚îú‚îÄ‚îÄ Code (25%)
‚îú‚îÄ‚îÄ Documentation (15%)
‚îú‚îÄ‚îÄ Custom Data (10%)
                        </div>
                    </div>
                </div>
            </div>

            <div class="step-advanced">
                <h5 class="text-primary mb-3">Step 2: Preprocessing</h5>
                <div class="code-example">
# Data preprocessing pipeline
def preprocess_text(text):
    # Remove HTML tags
    text = re.sub(r'<[^>]+>', '', text)

    # Normalize whitespace
    text = ' '.join(text.split())

    # Remove non-printable characters
    text = ''.join(char for char in text if char.isprintable())

    # Quality filtering
    if len(text) < 100:  # Too short
        return None
    if contains_profanity(text):  # Contains inappropriate content
        return None

    return text
                </div>
            </div>

            <div class="step-advanced">
                <h5 class="text-primary mb-3">Step 3: Tokenization & Formatting</h5>
                <div class="code-example">
# Tokenization for training
from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("microsoft/DialoGPT-medium")

def tokenize_for_training(texts, max_length=512):
    tokenized = tokenizer(
        texts,
        truncation=True,
        padding='max_length',
        max_length=max_length,
        return_tensors='pt'
    )
    return tokenized

# Format for causal language modeling
def format_for_clm(batch):
    batch["labels"] = batch["input_ids"].clone()
    return batch
                </div>
            </div>
        </div>

        <!-- Training Configuration -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-sliders-h text-primary me-2"></i>Training Configuration</h2>

            <div class="row">
                <div class="col-md-6">
                    <h5 class="text-warning mb-3">Core Hyperparameters</h5>
                    <div class="code-example">
# Training configuration
training_args = TrainingArguments(
    output_dir="./results",
    num_train_epochs=3,
    per_device_train_batch_size=4,
    per_device_eval_batch_size=4,
    warmup_steps=500,
    weight_decay=0.01,
    logging_dir="./logs",
    logging_steps=10,
    save_steps=500,
    evaluation_strategy="steps",
    eval_steps=500,
    load_best_model_at_end=True,
)
                    </div>
                </div>
                <div class="col-md-6">
                    <h5 class="text-info mb-3">Advanced Parameters</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>Learning Rate:</strong> 5e-5 to 2e-4 (start low, decay)</li>
                        <li class="list-group-item"><strong>Batch Size:</strong> 1-8 (GPU memory dependent)</li>
                        <li class="list-group-item"><strong>Gradient Accumulation:</strong> Effective batch size multiplier</li>
                        <li class="list-group-item"><strong>Mixed Precision:</strong> FP16 for 2x speed</li>
                        <li class="list-group-item"><strong>LoRA:</strong> Parameter-efficient fine-tuning</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Expert Project -->
        <div class="expert-project">
            <h2 class="h4 mb-4"><i class="fas fa-flask text-warning me-2"></i>Expert Project: Train a Domain-Specific Model</h2>

            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è Advanced Project:</strong> This project requires significant computational resources and ML expertise. Estimated time: 2-5 days.
            </div>

            <h5 class="text-primary mb-3">Project Overview</h5>
            <p>Train a specialized language model for a specific domain using your own dataset. This project demonstrates the complete machine learning pipeline from data to deployment.</p>

            <div class="row">
                <div class="col-md-8">
                    <h5 class="text-success mb-3">Project Steps</h5>
                    <div class="step-advanced">
                        <h6>Phase 1: Environment Setup (2-4 hours)</h6>
                        <ul class="small">
                            <li>Install PyTorch, Transformers, Accelerate</li>
                            <li>Set up CUDA/cuDNN for GPU acceleration</li>
                            <li>Configure Weights & Biases for monitoring</li>
                            <li>Prepare development environment</li>
                        </ul>
                    </div>

                    <div class="step-advanced">
                        <h6>Phase 2: Data Pipeline (4-8 hours)</h6>
                        <ul class="small">
                            <li>Collect domain-specific dataset (minimum 10GB text)</li>
                            <li>Implement preprocessing pipeline</li>
                            <li>Create train/validation/test splits</li>
                            <li>Set up data loading and tokenization</li>
                        </ul>
                    </div>

                    <div class="step-advanced">
                        <h6>Phase 3: Model Training (24-72 hours)</h6>
                        <ul class="small">
                            <li>Initialize base model architecture</li>
                            <li>Configure training hyperparameters</li>
                            <li>Implement monitoring and checkpointing</li>
                            <li>Handle training interruptions gracefully</li>
                        </ul>
                    </div>

                    <div class="step-advanced">
                        <h6>Phase 4: Evaluation & Deployment (4-8 hours)</h6>
                        <ul class="small">
                            <li>Evaluate model performance metrics</li>
                            <li>Compare with baseline models</li>
                            <li>Quantize and optimize for inference</li>
                            <li>Deploy to LM Studio for testing</li>
                        </ul>
                    </div>
                </div>

                <div class="col-md-4">
                    <h5 class="text-info mb-3">Success Metrics</h5>
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value">8.5+</div>
                            <div class="metric-label">Perplexity</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">85%</div>
                            <div class="metric-label">Domain Accuracy</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">&lt;2s</div>
                            <div class="metric-label">Response Time</div>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">4GB</div>
                            <div class="metric-label">Model Size</div>
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <strong>üí° Alternative:</strong> If full training is too resource-intensive, implement LoRA fine-tuning instead (covered in Session 14).
                    </div>
                </div>
            </div>
        </div>

        <!-- Training Best Practices -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-check-circle text-primary me-2"></i>Training Best Practices</h2>

            <div class="row">
                <div class="col-md-6">
                    <h5 class="text-success mb-3">Data Quality</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><i class="fas fa-filter text-primary me-2"></i><strong>Deduplication:</strong> Remove duplicate content</li>
                        <li class="list-group-item"><i class="fas fa-balance-scale text-primary me-2"></i><strong>Balance:</strong> Ensure diverse representation</li>
                        <li class="list-group-item"><i class="fas fa-shield-alt text-primary me-2"></i><strong>Safety:</strong> Filter harmful content</li>
                        <li class="list-group-item"><i class="fas fa-language text-primary me-2"></i><strong>Language:</strong> Consistent language/dialect</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5 class="text-info mb-3">Training Optimization</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><i class="fas fa-tachometer-alt text-info me-2"></i><strong>Gradient Checkpointing:</strong> Memory efficiency</li>
                        <li class="list-group-item"><i class="fas fa-compress text-info me-2"></i><strong>Mixed Precision:</strong> Speed optimization</li>
                        <li class="list-group-item"><i class="fas fa-save text-info me-2"></i><strong>Checkpointing:</strong> Regular model saves</li>
                        <li class="list-group-item"><i class="fas fa-chart-line text-info me-2"></i><strong>Early Stopping:</strong> Prevent overfitting</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Monitoring & Evaluation -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-chart-bar text-primary me-2"></i>Monitoring & Evaluation</h2>

            <div class="row">
                <div class="col-md-6">
                    <h5 class="text-primary mb-3">Key Metrics to Track</h5>
                    <div class="code-example">
// Training metrics
{
  "loss": 2.145,           // Training loss (lower better)
  "perplexity": 8.52,      // Model confidence (lower better)
  "learning_rate": 0.0001, // Current learning rate
  "epoch": 2.3,            // Training progress
  "step": 15420            // Training step
}
                    </div>
                </div>
                <div class="col-md-6">
                    <h5 class="text-info mb-3">Evaluation Methods</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item"><strong>Perplexity:</strong> How well model predicts text</li>
                        <li class="list-group-item"><strong>BLEU Score:</strong> Text generation quality</li>
                        <li class="list-group-item"><strong>Domain Accuracy:</strong> Performance on domain tasks</li>
                        <li class="list-group-item"><strong>Human Evaluation:</strong> Subjective quality assessment</li>
                        <li class="list-group-item"><strong>Inference Speed:</strong> Response time metrics</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Key Takeaways -->
        <div class="content-section">
            <h2 class="h4 mb-4"><i class="fas fa-lightbulb text-primary me-2"></i>Key Takeaways</h2>

            <div class="alert alert-dark">
                <h5 class="alert-heading"><i class="fas fa-atom me-2"></i>Expert-Level Training Mastery</h5>
                <ul class="mb-0">
                    <li><strong>Custom training</strong> enables domain specialization and privacy control</li>
                    <li><strong>Data quality</strong> is more important than quantity for training success</li>
                    <li><strong>Resource requirements</strong> scale dramatically with model size</li>
                    <li><strong>Monitoring and evaluation</strong> are critical for training success</li>
                    <li><strong>Optimization techniques</strong> can reduce training time and resource usage</li>
                    <li><strong>Practical deployment</strong> requires careful model optimization</li>
                </ul>
            </div>

            <div class="key-concept">
                <h4 class="h5 text-primary mb-3">üöÄ The Summit of AI Mastery</h4>
                <p>You've reached the pinnacle of AI training expertise. Custom model training represents the cutting edge of AI development, where you create tools that don't yet exist in the world.</p>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <a href="session12.html" class="btn btn-outline-secondary">
                <i class="fas fa-arrow-left me-2"></i>Previous: Production Deployment
            </a>
            <a href="session14.html" class="btn btn-primary">
                Next: Advanced Fine-tuning <i class="fas fa-arrow-right ms-2"></i>
            </a>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Mark session as completed
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof localStorage !== 'undefined') {
                const completedSessions = JSON.parse(localStorage.getItem('llm-course-completed') || '[]');
                if (!completedSessions.includes(13)) {
                    completedSessions.push(13);
                    localStorage.setItem('llm-course-completed', JSON.stringify(completedSessions));
                }
            }
        });
    </script>
</body>
</html>
